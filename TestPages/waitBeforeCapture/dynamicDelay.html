<html>
	<body>
		<p>Testing waitBeforeCapture (image delayed by: <span id='delay'></span> ms)</p>
		<script>
			const params = new Proxy(new URLSearchParams(window.location.search), {
				get: (searchParams, prop) => searchParams.get(prop),
			});
			const delay = parseInt(params.delay || '1000'); 
			function attachElement(){
				document.getElementById('delay').innerText = delay;
				setTimeout(() => {
					// adding the image only once
					if(document.getElementById('my_image'))
						return
					const newImage = document.createElement('img');
					newImage.setAttribute('id', 'my_image');
					newImage.src = './smurfs.jpg'
					document.querySelector('body').appendChild(newImage);
				}, delay)
			}
			attachElement()
		</script>	
	</body>
</html>