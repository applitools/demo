<html>
	<body>
		<p>Testing waitBeforeCapture <span id="counter">0</span>|<span id="wait"></span></p>
		<script>
			var timer = 0;
			const params = new Proxy(new URLSearchParams(window.location.search), {
				get: (searchParams, prop) => searchParams.get(prop),
			});
			const wait = params.wait || 'no set'; 
			function attachElement(){
				document.getElementById('wait').innerText = wait;
				setTimeout(() => {
					// adding the image only once
					if(document.getElementById('my_image'))
						return
					if(timer < 3){
						timer+=0.5;
						document.getElementById('counter').innerText = timer;
						attachElement()
					}else{
						const newImage = document.createElement('img');
						newImage.setAttribute("id", "my_image");
						newImage.src = './smurfs.jpg'
						document.querySelector('body').appendChild(newImage);
					}	
				}, 500)
			}
			attachElement()
		</script>	
	</body>
</html>